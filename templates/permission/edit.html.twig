{% extends 'base.html.twig' %}

{% block title %}Editer Permission{% endblock %}

{% block body %}
<section class="container col-md-8 col-xl-6 border border-primary py-4 px-4 custom-form">
    <div class="d-flex flex-row col-12">
      <h1 class="col-10">Editer Permission</h1>
      <img src="https://www.svgrepo.com/show/340721/no-image.svg" alt="Today Fit Permission Image" width="50px" class="col-2" id="permission-image">
    </div>

    {{ include('permission/_form.html.twig', {'button_label': 'Mettre à jour'}) }}
    {{ include('permission/_delete_form.html.twig') }}

    <a href="{{ path('app_permission_index') }}" class="btn btn-warning">Retourner à la liste</a>

</section>
{% endblock %}

{% block javascripts %}
  <script>
    window.onload = (event) => {
      let input = document.getElementById('permission_image')
      let image = document.getElementById('permission-image')
      image.src = input.value
      input.addEventListener("keyup", function(){
        image.src = input.value
        checkIfImgExists(image)
        console.log("input: ", input.value)
        console.log("image src: ", image.src)
      })
    }

    const checkIfImgExists = (image) => {
      const imageNotFound = () => {
        let newImage = document.getElementById('permission-image')
        newImage.src = "https://www.svgrepo.com/show/340721/no-image.svg"
      };

      const img = new Image()
      img.onerror = imageNotFound;
      img.src = image.src;
    }
  </script>
{% endblock %}
